{
  "hash": "2a7884cd2c2c48f2cb5fd614ed8e52cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Copulas in Stan\"\nsubtitle: \"Data-Level Dependence in Generalized Extreme Value Distributions\"\nauthor: \"Brynjólfur Gauti Guðrúnar Jónsson\"\ninstitute: \"University of Iceland\"\nformat: \n  revealjs:\n    theme: theme.scss\n    auto-stretch: true\n    simplemenu:\n      flat: false\n      barhtml:\n        header: \"<div class='menubar mb-10'><ul class='menu'></ul><div>\"\n        footer: \"<div class='footer footer-default' style='display: block;'> <a href='https://bggj.is/stancon24' target='_blank'>bggj.is/stancon24</a>  <img src='hi-audkenni_28-raunsvisd.png' class='slide-logo r-stretch'></div>\"\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nrevealjs-plugins:\n  - simplemenu\nbibliography: references.bib\ncsl: cambridge-university-press-numeric.csl\n---\n\n::: {.cell}\n\n:::\n\n\n\n\n## Introduction {data-name=\"Background\"}\n\n::::: {.columns style=\"font-size:70%\"}\n::: {.column width=\"70%\"}\n-   UKCP Local Projections on a 5km grid over the UK (1980-2080) [@metoffi]\n-   Challenge: Modeling maximum daily precipitation in yearly blocks\n    -   43,920 spatial locations on a 180 x 244 grid\n    -   Four parameters per location as in [@johannesson2021]\n        -   Location, Trend, Scale, Shape\n-   Two aspects of spatial dependence:\n    1.  GEV parameters (ICAR models)\n    2.  Data-level dependence (Copulas)\n:::\n\n::: {.column width=\"30%\"}\n![](images/ukcp_data.png){width=\"100%\"}\n:::\n:::::\n\n## Calculating Multivariate Normal Densities\n\n::::: {.columns style=\"font-size:60%\"}\n$$\n\\log f(\\mathbf{x}) \\propto \\frac{1}{2}\\left(\\log |\\mathbf{Q}| - \\mathbf{x}^T\\mathbf{Q}\\mathbf{x}\\right)\n$$\n\n::: {.column width=\"50%\"}\n\n### Computational challenges\n1.  **Log Determinant**: $\\log |\\mathbf{Q}|$\n    - Constant for a given precision matrix\n2.  **Quadratic Form**: $\\mathbf{x}^T\\mathbf{Q}\\mathbf{x}$\n    - Needs calculation for each density evaluation\n:::\n\n::: {.column width=\"50%\"}\n\n### Spatial Model Considerations\n\n* Some models (e.g., ICAR) avoid log determinant calculation\n* Efficient computation crucial for large-scale applications\n* Fast algorithms when $\\mathbf{Q}$ is sparse [@rue2001; @rue2005]\n\n:::\n:::::\n\n## Spatial Models\n\n::::::::::::::: {style=\"font-size:50%\"}\n#### Conditional Autoregression (CAR) [@besag1974]\n\n::::: columns\n::: {.column width=\"50%\"}\n-   $\\mathbf{D}$ is a diagonal matrix with $D_{ii} = n_i$, the number of neighbours of $i$\n-   $\\mathbf{A}$ is the adjacency matrix with $A_{ij} = A_{ji} = 1$ if $i \\sim j$\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &\\sim N(\\mathbf{0}, \\tau \\mathbf{Q}) \\\\\n\\mathbf{Q} &= \\mathbf{D}\\left(\\mathbf{I} - \\alpha \\mathbf{A} \\right)\n\\end{aligned}\n$$\n:::\n:::::\n\n------------------------------------------------------------------------\n\n\n#### Intrinsic Conditional Autoregression (ICAR) [@besag1991]\n::::: columns\n::: {.column width=\"50%\"}\n-   $\\alpha = 1$, so $\\mathbf Q$ is singular, but constant\n-   Don't have to calculate $\\log |\\mathbf{Q}|$\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &\\sim N(\\mathbf{0}, \\tau \\mathbf{Q}) \\\\\n\\mathbf{Q} &= \\mathbf{D} - \\mathbf{A}\n\\end{aligned}\n$$\n:::\n:::::\n\n------------------------------------------------------------------------\n\n\n::::: columns\n::: {.column width=\"50%\"}\n#### BYM (Besag-York-Mollié) Model [@besag1991]\n-   $\\mathbf{u}$ is the structured spatial component (Besag model)\n-   $\\mathbf{v}$ is the unstructured component (i.i.d. normal)\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &= \\mathbf{u} + \\mathbf{v} \\\\\n\\mathbf{u} &\\sim \\mathrm{ICAR}(\\tau_u) \\\\\n\\mathbf{v} &\\sim N(\\mathbf{0}, \\tau_v^{-1})\n\\end{aligned}\n$$\n:::\n:::::\n\n------------------------------------------------------------------------\n\n\n::::: columns\n::: {.column width=\"50%\"}\n#### BYM2 Model [@riebler2016;   @simpson2015]\n-   $\\rho$ models how much of variance is spatial\n-   $s$ is a scaling factor chosen to make $\\mathrm{Var}(\\mathbf u_i) \\approx 1$\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\mathbf{x} &= \\left(\\left(\\sqrt{\\rho/s}\\right)\\mathbf{u} + \\left(\\sqrt{1 - \\rho}\\right) \\mathbf{v} \\right)\\sigma \\\\\n\\mathbf{u} &\\sim \\mathrm{ICAR}(1) \\\\\n\\mathbf{v} &\\sim N(\\mathbf{0}, n)\n\\end{aligned}\n$$\n:::\n:::::\n:::::::::::::::\n\n## Spatial Modeling on Parameter-level\n\n::::: {.columns style=\"font-size:50%\"}\n::: {.column width=\"45%\"}\n-   $\\mu$: location parameter\n    -   $\\mu = \\mu_0 \\left(1 + \\Delta \\left(t - t_0\\right)\\right)$\n-   $\\sigma$: scale parameter\n-   $\\xi$: shape parameter \n$$\n\\begin{aligned}\n\\log(\\mu_0) = \\psi &\\sim \\mathrm{BYM2}(\\mu_\\psi, \\rho_\\psi, \\sigma_\\psi) \\\\\n\\log(\\mu_0) - \\log(\\sigma) = \\tau &\\sim \\mathrm{BYM2}(\\mu_\\tau, \\rho_\\tau, \\sigma_\\tau) \\\\\nf_\\xi(\\xi) = \\phi &\\sim \\mathrm{BYM2}(\\mu_\\phi, \\rho_\\phi, \\sigma_\\phi) \\\\\nf_\\Delta(\\Delta) = \\gamma &\\sim \\mathrm{BYM2}(\\mu_\\gamma, \\rho_\\gamma, \\sigma_\\gamma)\n\\end{aligned}\n$$ \n![](images/bym_table.png)\n:::\n\n::: {.column width=\"55%\"}\n![](images/facet_constrained.png)\n:::\n:::::\n\n## From Parameter-level to Data-level Dependence\n\n::::: {.columns style=\"font-size:60%\"}\n::: {.column width=\"50%\"}\n### Parameter-level Dependence\n\n-   Assumes conditional independence\n-   Biased joint probability estimates\n-   Underestimates parameter variance\n:::\n\n::: {.column width=\"50%\"}\n### Copula\n\n-   Improves joint probabilities\n-   Enhances spatial risk assessment\n-   Better variance estimates\n:::\n:::::\n\n::: {style=\"font-size:65%; margin-top:20px;\"}\n**Sklar's Theorem**: For any multivariate distribution $H$, there exists a unique copula $C$ such that:\n\n$$\nH(\\mathbf x) = C(F_1(x_1), \\dots, F_d(x_d))\n$$\n\nwhere $F_i$ are marginal distributions. We can also write this as a density\n\n$$\nh(x) = c(F_1(x_1), \\dots, F_d(x_d)) \\prod_{i=1}^d f_i(x_i)\n$$\n:::\n\n## Our Approach: Matérn-like Gaussian Copula\n\n::::: {style=\"font-size:55%\"}\n$$\n\\begin{gathered}\n\\log h(\\mathbf x) = \\log c\\left(F_1(x_1), \\dots, F_d(x_d)\\right) + \\sum_{i=1}^d \\log f_i(x_i)\n\\end{gathered}\n$$\n\n------------------------------------------------------------------------\n\n:::: columns\n### Marginal CDFs\n\n::: {.column width=\"50%\"}\n-   $F_i(x_i)$ is $\\mathrm{GEV}(\\mu_i, \\sigma_i, \\xi_i)$\n-   Can model parameter dependence with BYM2\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\log h(\\mathbf x) &= \\log c(u_1, \\dots, u_d) \\\\\n&+ \\sum_{i=1}^d \\log f_{\\mathrm{GEV}}(x_i \\vert \\mu_i, \\sigma_i, \\xi_i) \\\\\nu_i &= F_{\\mathrm{GEV}}(x_i \\vert \\mu_i, \\sigma_i, \\xi_i)\n\\end{aligned}\n$$\n:::\n::::\n\n------------------------------------------------------------------------\n\n:::: columns\n### Gaussian Copula\n\n::: {.column width=\"50%\"}\n-   Matérn-like precision matrix $\\mathbf{Q}$ [@lindgren2011]\n-   Scaled so $\\boldsymbol{\\Sigma} = \\mathbf{Q}^{-1}$ is correlation matrix\n-   If $\\mathbf{Q} = \\mathbf{I}$ simplifies to independent margins\n-   How to generate, scale and compute with $\\mathbf{Q}$ quickly (for MCMC)?\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\begin{aligned}\n\\log c(\\mathbf u) &\\propto \\frac{1}{2}\\left(\\log |\\mathbf{Q}| - \\mathbf{z}^T\\mathbf{Q}\\mathbf{z} + \\mathbf{z}^T\\mathbf{z}\\right) \\\\\n\\mathbf{z} &= \\Phi^{-1}(\\mathbf u)\n\\end{aligned}\n$$\n:::\n::::\n:::::\n\n## The Precision Matrix {data-name=\"Methods\"}\n\n:::::: {style=\"font-size:60%\"}\n$\\mathbf Q$ defined as Kronecker sum of two AR(1) precision matrices, similar to [@lindgren2011]\n\n$$\n\\mathbf{Q} = \\left( \\mathbf{Q}_{\\rho_1} \\otimes \\mathbf{I_{n_2}} + \\mathbf{I_{n_1}} \\otimes \\mathbf{Q}_{\\rho_2} \\right)^{\\nu + 1}, \\quad \\nu \\in \\{0, 1, 2\\}\n$$\n\n::::: {.columns style=\"font-size:80%\"}\n::: {.column width=\"50%\"}\n$$\n\\mathbf{Q}_{\\rho_{1}} = \\frac{1}{1-\\rho_{1}^2}\n\\begin{bmatrix}\n1 & -\\rho_{1} & 0 & \\cdots & 0 \\\\\n-\\rho_{1} & 1+\\rho_{1}^2 & -\\rho_{1} & \\cdots & 0 \\\\\n0 & -\\rho_{1} & 1+\\rho_{1}^2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 1\n\\end{bmatrix}\n$$\n:::\n\n::: {.column width=\"50%\"}\n$$\n\\mathbf{Q}_{\\rho_{2}} = \\frac{1}{1-\\rho_{2}^2}\n\\begin{bmatrix}\n1 & -\\rho_{2} & 0 & \\cdots & 0 \\\\\n-\\rho_{2} & 1+\\rho_{2}^2 & -\\rho_{2} & \\cdots & 0 \\\\\n0 & -\\rho_{2} & 1+\\rho_{2}^2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 1\n\\end{bmatrix}\n$$\n:::\n\n$$\n\\mathbf Q = \\begin{bmatrix}\n\\frac{1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} + \\mathbf{Q_{\\rho_2}} & \\frac{-\\rho_1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} & \\dots & \\cdots & \\dots \\\\\n\\frac{-\\rho_1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} & \\frac{(1+\\rho_1^2)}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} + \\mathbf{Q_{\\rho_2}} & \\frac{-\\rho_1}{(1-\\rho_1^2)} \\mathbf{I_{n_2}} & \\cdots & \\vdots  \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & \\vdots \\\\\n\\dots & \\dots & \\cdots & \\frac{-\\rho_1}{(1-\\rho_1^2)} \\mathbf{I_{n_2}} & \\frac{1}{(1-\\rho_1^2)}\\mathbf{I_{n_2}} + \\mathbf{Q_{\\rho_2}}\n\\end{bmatrix}^{\\nu + 1}\n$$\n:::::\n::::::\n\n## Eigendecomposition\n\n::::: {.columns style=\"font-size:65%\"}\nBecause of how $\\mathbf{Q}$ is defined [@horn1991], we know that\n\n$$\n\\begin{aligned}\n\\mathbf{Q} &= \\mathbf{V}\\boldsymbol{\\Lambda}\\mathbf{V} \\\\\n&= (\\mathbf{V_{\\rho_1}} \\otimes \\mathbf{V_{\\rho_2}})(\\boldsymbol \\Lambda_{\\rho_1} \\otimes \\mathbf{I} + \\mathbf{I} \\otimes \\boldsymbol \\Lambda_{\\rho_2})^{\\nu + 1}(\\mathbf{V_{\\rho_1}} \\otimes \\mathbf{V_{\\rho_2}})^T\n\\end{aligned}\n$$\n\nwhere\n\n$$\n\\begin{aligned}\n\\mathbf{Q}_{\\rho_1} = \\mathbf{V_{\\rho_1}}\\boldsymbol \\Lambda_{\\rho_1}\\mathbf{V_{\\rho_1}}^T \\qquad \\& \\qquad\n\\mathbf{Q}_{\\rho_2} = \\mathbf{V_{\\rho_2}}\\boldsymbol \\Lambda_{\\rho_2}\\mathbf{V_{\\rho_2}}^T\n\\end{aligned}\n$$\n\nSpectral decomposition defined by value/vector pairs of smaller matrices\n\n::: {.column width=\"50%\"}\n$$\n\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\n$$\n:::\n\n::: {.column widht=\"50%\"}\n$$\n\\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j\n$$\n:::\n\n-   Problem: $\\boldsymbol \\Sigma_{ii} = \\left(\\mathbf Q^{-1} \\right)_{ii} \\neq  1$\n-   Solution: $\\mathbf{\\widetilde  Q} = \\mathbf{D}\\mathbf{Q}\\mathbf{D}$, where $\\mathbf D_{ii} = \\sqrt{\\boldsymbol \\Sigma_{ii}}$\n:::::\n\n## Marginal Standard Deviations\n\n::: {style=\"font-size:70%\"}\n$$\n\\boldsymbol \\Sigma = \\mathbf Q^{-1} = (\\mathbf{V}\\boldsymbol\\Lambda\\mathbf{V}^T)^{-1} = \\mathbf{V}\\boldsymbol \\Lambda^{-1}\\mathbf{V}\n$$\n\nWe know that if $A = BC$ then $A_{ii} = B_{i, .} C_{., i}$, so\n\n$$\n\\boldsymbol \\Sigma_{ii} = \\sum_{k=1}^{n} v_{ik} \\frac{1}{\\lambda_k} (v^T)_{ki} = \\sum_{k=1}^{n} v_{ik} \\frac{1}{\\lambda_k} v_{ik} = \\sum_{k=1}^{n} v_{ik}^2 \\frac{1}{\\lambda_k}\n$$\n\nCompute vector $\\boldsymbol \\sigma^2$ containing all marginal variances\n\n$$ \n\\boldsymbol \\sigma^2 = \\sum_{i = 1}^{n_1} \\sum_{j=1}^{n_2} \\frac{\\left(\\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j\\right)^{2}}{\\quad\\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)^{\\nu+1}}\n$$\n:::\n\n## Marginal Standard Deviations\n\n::::: {.columns style=\"font-size:75%\"}\n::: {.column width=\"58%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim1 <- 50; dim2 <- 50\nrho1 <- 0.5; rho2 <- 0.3\nnu <- 2\n\nQ1 <- make_AR_prec_matrix(dim1, rho1)\nQ2 <- make_AR_prec_matrix(dim2, rho2)\n\nI1 <- Matrix::Diagonal(dim1)\nI2 <- Matrix::Diagonal(dim2)\n\nQ <- temp <- kronecker(Q1, I2) + kronecker(I1, Q2)\nfor (i in seq_len(nu)) Q <- Q %*% temp\n```\n:::\n\n\n\n:::\n\n::: {.column width=\"42%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmsd <- function(Q1, Q2) {\n\n  E1 <- eigen(Q1)\n  E2 <- eigen(Q2)\n\n  marginal_sd_eigen(\n    E1$values, E1$vectors, dim1,\n    E2$values, E2$vectors, dim2,\n    nu\n  ) |> \n  sort()\n}\n```\n:::\n\n\n\n:::\n:::::\n\n::: {style=\"font-size:75%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbench::mark(\n  \"solve\" = solve(Q) |> diag() |> sqrt() |> sort(),\n  \"inla.qinv\" = inla.qinv(Q) |> diag() |> sqrt() |> sort(),\n  \"marginal_sd_eigen\" = msd(Q1, Q2),\n  iterations = 10,\n  filter_gc = FALSE \n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 6\n  expression             min   median `itr/sec` mem_alloc `gc/sec`\n  <bch:expr>        <bch:tm> <bch:tm>     <dbl> <bch:byt>    <dbl>\n1 solve                1.27s     1.3s     0.755   78.17MB    0.755\n2 inla.qinv         378.61ms  395.8ms     2.49     4.35MB    0    \n3 marginal_sd_eigen   1.36ms   1.54ms   574.     649.35KB    0    \n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Calculating the (non-copula) density\n\n::: {style=\"font-size:70%\"}\nThe Gaussian log pdf is \n$$\n\\log f(\\mathbf{u} \\vert \\mathbf{Q}) \\propto \\frac{1}{2}\\left(\\log|\\mathbf{Q}| - \\mathbf{z}^T\\mathbf{Q}\\mathbf{z}\\right)\n$$\n\nWithout scaling of $\\mathbf Q$ we get\n\n$$\n\\log|\\mathbf{Q}| = \\sum_{k=1}^{n_1n_2}\\log\\lambda_k = \\sum_{i=1}^{n_1}\\sum_{j=2}^{n_2} \\log\\left[\\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)^{\\nu + 1}\\right]\n$$\n\n$$\n\\mathbf{z}^T\\mathbf{Q}\\mathbf{z} = \\sum_{k=1}^{n_1n_2}\\lambda_k \\left(v_k^T\\mathbf z\\right)^2 = \n\\sum_{i=1}^{n_1}\\sum_{j=2}^{n_2} \n\\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)\n\\left[\\left(\\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j\\right)^T\\mathbf z\\right]^2\n$$\n:::\n\n## Calculating the copula density\n\n::: {style=\"font-size:70%\"}\nLet $\\mathbf v = \\left\\{\\mathbf{v}_{\\rho_1}\\right\\}_i \\otimes \\left\\{\\mathbf{v}_{\\rho_2}\\right\\}_j$ and $\\lambda = \\left(\\left\\{\\lambda_{\\rho_1}\\right\\}_i + \\left\\{\\lambda_{\\rho_2}\\right\\}_j\\right)^{\\nu + 1}$. Normalise $\\mathbf v$ and $\\lambda$ with\n\n$$\n\\begin{gathered}\n\\widetilde{\\mathbf{v}} = \\frac{\\sigma \\odot \\mathbf{v}}{\\vert\\vert \\sigma \\odot\\mathbf{v}\\vert\\vert_2}, \\qquad\n\\widetilde{\\lambda} = \\vert\\vert \\sigma \\odot\\mathbf{v}\\vert\\vert_2^2 \\cdot \\lambda\n\\end{gathered}\n$$\n\nThen $\\widetilde{\\mathbf{v}}$ and $\\widetilde{\\lambda}$ are an eigenvector/value pair of the scaled precision matrix $\\mathbf{\\widetilde{Q}}$. Iterate over $i$ and $j$ to calculate\n\n$$\n\\log c(\\mathbf{u} \\vert \\mathbf{\\widetilde{Q}}) = \\frac{1}{2}\\log|\\mathbf{\\widetilde Q}| - \\frac{1}{2}\\mathbf{z}^T\\mathbf{\\widetilde Q}\\mathbf{z} + \\frac{1}{2}\\mathbf{z}^T\\mathbf{z}\n$$\n:::\n\n## Folded Circulant Approximation\n\n:::::::::::: {style=\"font-size:40%\"}\n::::: columns\n::: {.column width=\"40%\"}\n### AR(1) precision\n\nThe exact form of $Q_{\\rho}$, the precision matrix of a one-dimensional AR(1) process with correlation $\\rho$\n:::\n\n::: {.column width=\"60%\"}\n$$\n\\mathbf{Q}_\\rho = \\frac{1}{1-\\rho^2}\n\\begin{bmatrix}\n1 & -\\rho & 0 & \\cdots & 0 \\\\\n-\\rho & 1+\\rho^2 & -\\rho & \\cdots & 0 \\\\\n0 & -\\rho & 1+\\rho^2 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & 1\n\\end{bmatrix}\n$$\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"40%\"}\n### Circulant Approximation\n\nThis approximation treats the first and last observations as neighbors, effectively wrapping the data around a circle. Very fast computation using FFT [@rue2005]\n:::\n\n::: {.column width=\"60%\"}\n$$\n\\mathbf{Q}_\\rho^{(circ)} = \\frac{1}{1-\\rho^2}\n\\begin{bmatrix}\n1+\\rho^2 & -\\rho & 0 & \\cdots & 0 & -\\rho \\\\\n-\\rho & 1+\\rho^2 & -\\rho & \\cdots & 0 & 0 \\\\\n0 & -\\rho & 1+\\rho^2 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n-\\rho & 0 & 0 & \\cdots & -\\rho & 1+\\rho^2\n\\end{bmatrix}\n$$\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"40%\"}\n### Folded Circulant Approximation [@kent2022; @mondal2018]\n\nWe double the data by reflecting it, giving us the data $x_1,  \\dots, x_n, x_n, \\dots, x_1$. We then model this doubled data with a $2n \\times 2n$ circulant matrix. Get fast computation like in circulant case, but better boundary conditions. Quadratic form written out as an $n \\times n$ matrix takes the form on the right.\n:::\n\n::: {.column width=\"60%\"}\n$$\n\\mathbf{Q}_\\rho^{(fold)} = \\frac{1}{1-\\rho^2}\n\\begin{bmatrix}\n1-\\rho+\\rho^2 & -\\rho & 0 & \\cdots & 0 & 0 \\\\\n-\\rho & 1+\\rho^2 & -\\rho & \\cdots & 0 & 0 \\\\\n0 & -\\rho & 1+\\rho^2 & \\cdots & 0 & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & -\\rho & 1-\\rho+\\rho^2\n\\end{bmatrix}\n$$\n:::\n:::::\n::::::::::::\n\n## Benchmark: Density Computations {data-name=\"Results\"}\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"uyfvbicrqa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#uyfvbicrqa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#uyfvbicrqa thead, #uyfvbicrqa tbody, #uyfvbicrqa tfoot, #uyfvbicrqa tr, #uyfvbicrqa td, #uyfvbicrqa th {\n  border-style: none;\n}\n\n#uyfvbicrqa p {\n  margin: 0;\n  padding: 0;\n}\n\n#uyfvbicrqa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#uyfvbicrqa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#uyfvbicrqa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#uyfvbicrqa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#uyfvbicrqa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#uyfvbicrqa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#uyfvbicrqa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#uyfvbicrqa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#uyfvbicrqa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#uyfvbicrqa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#uyfvbicrqa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#uyfvbicrqa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#uyfvbicrqa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#uyfvbicrqa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#uyfvbicrqa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#uyfvbicrqa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#uyfvbicrqa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#uyfvbicrqa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#uyfvbicrqa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#uyfvbicrqa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#uyfvbicrqa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#uyfvbicrqa .gt_left {\n  text-align: left;\n}\n\n#uyfvbicrqa .gt_center {\n  text-align: center;\n}\n\n#uyfvbicrqa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#uyfvbicrqa .gt_font_normal {\n  font-weight: normal;\n}\n\n#uyfvbicrqa .gt_font_bold {\n  font-weight: bold;\n}\n\n#uyfvbicrqa .gt_font_italic {\n  font-style: italic;\n}\n\n#uyfvbicrqa .gt_super {\n  font-size: 65%;\n}\n\n#uyfvbicrqa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#uyfvbicrqa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#uyfvbicrqa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#uyfvbicrqa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#uyfvbicrqa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#uyfvbicrqa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#uyfvbicrqa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#uyfvbicrqa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#uyfvbicrqa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><div data-qmd-base64=\"QmVuY2htYXJraW5nIGhvdyBsb25nIGl0IHRha2VzIHRvIGV2YWx1YXRlIHRoZSBkZW5zaXR5IG9mIGEgTcOhdGVybigkXG51JCktbGlrZSBmaWVsZCB3aXRoIGNvcnJlbGF0aW9uIHBhcmFtZXRlciAkXHJobyQsIGVpdGhlciB1bnNjYWxlZCBvciBzY2FsZWQgdG8gaGF2ZSB1bml0IG1hcmdpbmFsIHZhcmlhbmNl\"><div class='gt_from_md'><p>Benchmarking how long it takes to evaluate the density of a Mátern($\\nu$)-like field with correlation parameter \\(\\rho\\), either unscaled or scaled to have unit marginal variance</p>\n</div></div></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"3\" scope=\"colgroup\" id=\"Unscaled\">\n        <span class=\"gt_column_spanner\">Unscaled</span>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"5\" scope=\"colgroup\" id=\"Scaled\">\n        <span class=\"gt_column_spanner\">Scaled</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Grid\">Grid</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Cholesky\">Cholesky</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Eigen\">\n        <span class=\"gt_column_spanner\">Eigen</span>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Eigen\">Eigen</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Circulant\">\n        <span class=\"gt_column_spanner\">Circulant</span>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Folded\">\n        <span class=\"gt_column_spanner\">Folded</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Relative\">Relative</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Relative\">Relative</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Relative\">Relative</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">20x20</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">312.56µs</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">155.88µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">49.9%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">235.59µs</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">36.2µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">15.4%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">115.09µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">48.9%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">40x40</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">1.77ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">543.76µs</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">30.7%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">1.65ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">115.8µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">7.0%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">300.9µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">18.3%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">60x60</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">6.33ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">1.8ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">28.5%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">7.1ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">188.48µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">2.7%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">609.71µs</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">8.6%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">80x80</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">17.98ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">5.17ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">28.8%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">21.96ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">338.15µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">1.5%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">1.26ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">5.7%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">100x100</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">38.58ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">11.48ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">29.8%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">48.44ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">445.14µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.9%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">2.37ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">4.9%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">120x120</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">81.1ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">22.74ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">28.0%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">88.45ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">719.55µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.8%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">2.82ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">3.2%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">140x140</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">145.26ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">32.55ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">22.4%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">168.38ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">965.71µs</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.6%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">5.39ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">3.2%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">160x160</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">233.03ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">54.51ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">23.4%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">260.7ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">1.27ms</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.5%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">5.33ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">2.0%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">180x180</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">359.21ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">97.4ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">27.1%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">482.93ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">1.61ms</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.3%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">10.22ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">2.1%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">200x200</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">567.01ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">147.51ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">26.0%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">676.53ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">1.84ms</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.3%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">8.62ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">1.3%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">220x220</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">791.13ms</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">206.13ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">26.1%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">994.11ms</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">2.59ms</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.3%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">13.55ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">1.4%</td></tr>\n    <tr><td headers=\"Grid\" class=\"gt_row gt_left\">240x240</td>\n<td headers=\"Cholesky (Unscaled)\" class=\"gt_row gt_left\">1.07s</td>\n<td headers=\"Eigen (Unscaled)\" class=\"gt_row gt_left\">287ms</td>\n<td headers=\"sp_3\" class=\"gt_row gt_right\">26.8%</td>\n<td headers=\"eig\" class=\"gt_row gt_left\">1.34s</td>\n<td headers=\"circ\" class=\"gt_row gt_left\">2.82ms</td>\n<td headers=\"sp_1\" class=\"gt_row gt_right\">0.2%</td>\n<td headers=\"fol\" class=\"gt_row gt_left\">14.77ms</td>\n<td headers=\"sp_2\" class=\"gt_row gt_right\">1.1%</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n## Benchmark: Maximum Likelihood\n\n::::: {.columns style=\"font-size:50%\"}\n::: {.column width=\"65%\"}\n![](images/bench_ml_bias.png)\n:::\n\n::: {.column width=\"35%\"}\n<br> <br>\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"nmiqecejaw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#nmiqecejaw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#nmiqecejaw thead, #nmiqecejaw tbody, #nmiqecejaw tfoot, #nmiqecejaw tr, #nmiqecejaw td, #nmiqecejaw th {\n  border-style: none;\n}\n\n#nmiqecejaw p {\n  margin: 0;\n  padding: 0;\n}\n\n#nmiqecejaw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#nmiqecejaw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#nmiqecejaw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#nmiqecejaw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#nmiqecejaw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#nmiqecejaw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#nmiqecejaw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#nmiqecejaw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#nmiqecejaw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#nmiqecejaw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#nmiqecejaw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#nmiqecejaw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#nmiqecejaw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#nmiqecejaw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#nmiqecejaw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#nmiqecejaw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#nmiqecejaw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#nmiqecejaw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#nmiqecejaw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#nmiqecejaw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#nmiqecejaw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#nmiqecejaw .gt_left {\n  text-align: left;\n}\n\n#nmiqecejaw .gt_center {\n  text-align: center;\n}\n\n#nmiqecejaw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#nmiqecejaw .gt_font_normal {\n  font-weight: normal;\n}\n\n#nmiqecejaw .gt_font_bold {\n  font-weight: bold;\n}\n\n#nmiqecejaw .gt_font_italic {\n  font-style: italic;\n}\n\n#nmiqecejaw .gt_super {\n  font-size: 65%;\n}\n\n#nmiqecejaw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#nmiqecejaw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#nmiqecejaw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#nmiqecejaw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#nmiqecejaw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#nmiqecejaw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#nmiqecejaw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#nmiqecejaw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#nmiqecejaw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><div data-qmd-base64=\"QmVuY2htYXJraW5nIHNwZWVkIG9mIE1MIGNvbXB1dGF0aW9ucw==\"><div class='gt_from_md'><p>Benchmarking speed of ML computations</p>\n</div></div></caption>\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Grid Size\">Grid Size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Exact\">Exact</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Folded\">\n        <span class=\"gt_column_spanner\">Folded</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Time\">Time</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Speed-Up\">Speed-Up</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">10 x 10</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">6.86ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">2.42ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">2.84x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">20 x 20</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">15.42ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">7.64ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">2.02x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">30 x 30</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">35.02ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">12.13ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">2.89x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">40 x 40</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">75.03ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">19.43ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">3.86x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">50 x 50</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">150.24ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">28.68ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">5.24x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">60 x 60</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">284.12ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">40.26ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">7.06x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">70 x 70</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">485.3ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">54.8ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">8.86x</td></tr>\n    <tr><td headers=\"dim\" class=\"gt_row gt_left\">80 x 80</td>\n<td headers=\"Exact\" class=\"gt_row gt_left\">754.37ms</td>\n<td headers=\"fold\" class=\"gt_row gt_left\">74.66ms</td>\n<td headers=\"d_1\" class=\"gt_row gt_left\">10.1x</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n:::::\n\n## Approximating the Correlation Matrix\n\n![](images/cors.png)\n\n## Data Generation\n\n::::: {.columns style=\"font-size:60%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic()\nX <- rmatern_copula_folded_full(n = 100, dim1 = 400, dim2 = 180, rho1 = 0.8, rho2 = 0.9, nu = 2)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1.334 sec elapsed\n```\n\n\n:::\n:::\n\n\n\n\n::: {.column width=\"50%;text-align:center\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_matern(X[, 1], 400, 180)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-7-1.png){width=80%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_matern(X[, 2], 400, 180)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-8-1.png){width=80%}\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\napply(X, 1, var) |> hist()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-9-1.png){width=80%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\napply(X, 1, mean) |> hist()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-10-1.png){width=80%}\n:::\n:::\n\n\n\n:::\n:::::\n\n## Conclusion and Future Work {data-name=\"Conclusion\"}\n\n::::: {.columns style=\"font-size:60%\"}\n::: {.column width=\"50%\"}\n### Key Results\n\n-   Developed Matérn-like Gaussian copula for large spatial fields\n-   Folded circulant approximation to the density\n-   Achieved fast density computations\n-   Viable for MCMC samplers\n:::\n\n::: {.column width=\"50%\"}\n### Future Work\n\n-   Implement t-copulas\n-   Apply to other environmental and climate datasets\n-   [Finish drafting paper](https://www.bggj.is/materneigenpaper)\n-   [R package](https://www.github.com/bgautijonsson/stdmatern)\n:::\n\n------------------------------------------------------------------------\n\n### PhD Committee\n\nMy thanks to my advisor and committee\n\n-   Birgir Hrafnkelsson (PI)\n-   Raphaël Huser\n-   Stefan Siegert\n:::::\n\n# References\n\n::: {#refs style=\"font-size:60%\"}\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}